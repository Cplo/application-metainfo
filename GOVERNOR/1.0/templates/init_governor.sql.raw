DROP TABLE IF EXISTS repository;
DROP TABLE IF EXISTS governor_favorite_databases;
DROP TABLE IF EXISTS governor_favorite_items;
DROP TABLE IF EXISTS governor_database_items;
DROP TABLE IF EXISTS governor_databases;
DROP TABLE IF EXISTS governor_table_count;
DROP TABLE IF EXISTS governor_procedure_count;
DROP TABLE IF EXISTS version;
DROP TABLE IF EXISTS governor_table_operations;
DROP TABLE IF EXISTS governor_procedure_operations;

CREATE TABLE governor_databases(
  `database_id`     VARCHAR(255) NOT NULL PRIMARY KEY,
  `database_name`   VARCHAR(255) NOT NULL,
  `repository_name` VARCHAR(255) NOT NULL,
  `is_existed`      BOOLEAN NOT NULL
)ENGINE=InnoDB CHARSET=utf8;

CREATE TABLE governor_database_items (
  `item_id`     VARCHAR(255) PRIMARY KEY NOT NULL,
  `item_name`   VARCHAR(255) NOT NULL,
  `item_type`   VARCHAR(30) NOT NULL,
  `database_id` VARCHAR(255) NOT NULL,
  `is_existed`  BOOLEAN NOT NULL
)ENGINE=InnoDB CHARSET=utf8;

CREATE TABLE governor_favorite_databases(
  `user`           VARCHAR(50) NOT NULL,
  `database_id`    VARCHAR(255) NOT NULL,
  `favorite_level` VARCHAR(13) NOT NULL,
  `favortie_time`  DATETIME NOT NULL,
  PRIMARY KEY (`user`, `database_id`)
)ENGINE=InnoDB CHARSET=utf8;

CREATE TABLE governor_favorite_items(
  `user`       VARCHAR(50) NOT NULL,
  `item_id`    VARCHAR(255) NOT NULL,
  `favortie_time` DATETIME NOT NULL,
  PRIMARY KEY (`user`, `item_id`)
)ENGINE=InnoDB CHARSET=utf8;

CREATE TABLE governor_table_count(
  `date`       BIGINT(20) NOT NULL,
  `repository` VARCHAR(100) NOT NULL,
  `type`       VARCHAR(30) NOT NULL,
  `number`     INT(11) NOT NULL,
  `size`       BIGINT(20) NOT NULL
) DEFAULT CHARSET=utf8;

ALTER TABLE `governor_table_count` ADD INDEX index_name (`date`);

CREATE TABLE governor_procedure_count(
  `date`       BIGINT(20) NOT NULL,
  `repository` VARCHAR(100) NOT NULL,
  `number`     INT(11) NOT NULL,
  `success`    INT(11) NOT NULL,
  `error`      INT(11) NOT NULL
) DEFAULT CHARSET=utf8;

ALTER TABLE `governor_procedure_count` ADD INDEX index_name (`date`);

#record the operations of tables
CREATE TABLE `governor_table_operations` (
  `table_id`         VARCHAR(255) NOT NULL,
  `table_store_type` VARCHAR(50)  NOT NULL,
  `op_type`          VARCHAR(20)  NOT NULL,
  `size`             BIGINT       NOT NULL,
  `result`           VARCHAR(20)  NOT NULL,
  `time`             DATETIME     NOT NULL
)ENGINE=InnoDB CHARSET=utf8;

#record the operations of procedures
CREATE TABLE `governor_procedure_operations` (
  `procedure_id`   VARCHAR(255) NOT NULL,
  `op_type`        VARCHAR(20)  NOT NULL,
  `result`         VARCHAR(20)  NOT NULL,
  `time`           DATETIME     NOT NULL
) ENGINE=InnoDB CHARSET=utf8;

CREATE TABLE repository (
  `id`              INT NOT NULL AUTO_INCREMENT,   
  `repo_name`       VARCHAR(45) NULL,   
  `repo_connection` VARCHAR(45) NULL,   
  `repo_hdfs_id`    VARCHAR(45) NULL,   
  `create_time`     DATETIME NOT NULL,   
  `owner`           VARCHAR(45) NULL,   
  PRIMARY KEY (`id`)
)ENGINE = InnoDB; 

CREATE TABLE version (
  `version_id`      BIGINT(20) NOT NULL,
  `schema_version`  VARCHAR(127) NOT NULL,
  `version_comment` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`version_id`)
)ENGINE=InnoDB CHARSET=utf8;